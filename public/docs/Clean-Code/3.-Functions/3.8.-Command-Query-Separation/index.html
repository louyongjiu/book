<!DOCTYPE html>
<html lang="zh" dir=>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="3.8 分隔指令与询问 #  Functions should either do something or answer something, but not both. Either your function should change the state of an object, or it should return some information about that object. Doing both often leads to confusion. Consider, for example, the following function:
 函数要么做什么事，要么回答什么事，但二者不可得兼。函数应该修改某对象的状态，或是返回该对象的有关信息。两样都干常会导致混乱。看看下面的例子：
 public boolean set(String attribute, String value); This function sets the value of a named attribute and returns true if it is successful and false if no such attribute exists.">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="3.8. 分隔指令与询问&#34;" />
<meta property="og:description" content="3.8 分隔指令与询问 #  Functions should either do something or answer something, but not both. Either your function should change the state of an object, or it should return some information about that object. Doing both often leads to confusion. Consider, for example, the following function:
 函数要么做什么事，要么回答什么事，但二者不可得兼。函数应该修改某对象的状态，或是返回该对象的有关信息。两样都干常会导致混乱。看看下面的例子：
 public boolean set(String attribute, String value); This function sets the value of a named attribute and returns true if it is successful and false if no such attribute exists." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://book.ninescloud.com/docs/Clean-Code/3.-Functions/3.8.-Command-Query-Separation/" />
<meta property="article:modified_time" content="2020-09-01T10:16:42+08:00" />
<title>3.8. 分隔指令与询问&#34; | Book</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.6cd8553a6854f4812343f0f0c8baca31271e686434f381fbe3c7226f66639176.css" integrity="sha256-bNhVOmhU9IEjQ/DwyLrKMSceaGQ084H748cib2ZjkXY=">
<script defer src="/zh.search.min.5e3b717b0686f788252a3dd9f628944a27e58985fc0a36655b371cb064849d0d.js" integrity="sha256-XjtxewaG94glKj3Z9iiUSifliYX8CjZlWzccsGSEnQ0="></script>

<script defer src="/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js" integrity="sha256-dKi7B/C&#43;6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body dir=>
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/"><span>Book</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="搜索" aria-label="搜索" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  
  
  

  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
    <a href="/docs/Clean-Code/" class="collapsed ">代码整洁之道</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/1.-Clean-Code/" class="">1. 整洁代码</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/1.-Clean-Code/1.1.-There-Will-Be-Code/" class="">1.1. 要有代码</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/1.-Clean-Code/1.2.-Bad-Code/" class="">1.2. 糟糕的代码</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/1.-Clean-Code/1.3.-The-Total-Cost-of-Owning-a-Mess/" class="">1.3. 混乱的代价</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/1.-Clean-Code/1.4.-Schools-of-Thought/" class="">1.4. 思想流派</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/1.-Clean-Code/1.5.-We-Are-Authors/" class="">1.5. 我们是作者</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/1.-Clean-Code/1.6.-The-Boy-Scout-Rule/" class="">1.6. 童子军军规</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/1.-Clean-Code/1.7.-Prequel-and-Principles/" class="">1.7. 前传与原则</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/1.-Clean-Code/1.8.-Conclusion/" class="">1.8. 小结</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/1.-Clean-Code/1.9.-Bibliography/" class="">1.9. 参考文献</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/" class="">2. 有意义的命名</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.1.-Introduction/" class="">2.1. 介绍</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.2.-Use-Intention-Revealing-Names/" class="">2.2. 名副其实</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.3.-Avoid-Disinformation/" class="">2.3. 避免误导</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.4.-Make-Meaningful-Distinctions/" class="">2.4. 做有意义的区分</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.5.-Use-Pronounceable-Names/" class="">2.5. 使用读得出来的名称</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.6.-Use-Searchable-Names/" class="">2.6. 使用可搜索的名称</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.7.-Avoid-Encodings/" class="">2.7. 避免使用编码</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.8.-Avoid-Mental-Mapping/" class="">2.8. 避免思维映射</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.9.-Class-Names/" class="">2.9. 类名</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.10.-Method-Names/" class="">2.10. 方法名</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.11.-Dont-Be-Cute/" class="">2.11. 别扮可爱</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.12.-Pick-One-Word-per-Concept/" class="">2.12. 每个概念对应一个词</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.13.-Dont-Pun/" class="">2.13. 别用双关语</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.14.-Use-Solution-Domain-Names/" class="">2.14. 使用解决方案领域名称</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.15.-Use-Problem-Domain-Names/" class="">2.15. 使用源自所涉问题领域的名称</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.16.-Add-Meaningful-Context/" class="">2.16. 添加有意义的语境</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.17.-Dont-Add-Gratuitous-Context/" class="">2.17. 不要添加没用的语境</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/2.-Meaningful-Names/2.18.-Final-Words/" class="">2.18. 最后的话</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/3.-Functions/" class="">3. 函数</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/3.-Functions/3.1.-Small/" class="">3.1. 短小</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/3.-Functions/3.2.-Do-One-Thing/" class="">3.2. 只做一件事&#34;</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/3.-Functions/3.3.-One-Level-of-Abstraction-per-Function/" class="">3.3. 每个函数一个抽象层级&#34;</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/3.-Functions/3.4.-Switch-Statements-/" class="">3.4. switch 语句&#34;</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/3.-Functions/3.5.-Use-Descriptive-Names/" class="">3.5. 使用描述性的名称&#34;</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/3.-Functions/3.6.-Function-Arguments/" class="">3.6. 函数参数&#34;</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/3.-Functions/3.7.-Have-No-Side-Effects/" class="">3.7. 无副作用&#34;</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/3.-Functions/3.8.-Command-Query-Separation/" class="active">3.8. 分隔指令与询问&#34;</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/3.-Functions/3.9.-Prefer-Exceptions-to-Returning-Error-Codes/" class="">3.9. 使用异常替代返回错误码&#34;</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/3.-Functions/3.10.-Dont-Repeat-Yourself/" class="">3.10. 别重复自己&#34;</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/3.-Functions/3.11.-Structured-Programming/" class="">3.11. 结构化编程&#34;</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/3.-Functions/3.12.-How-Do-You-Write-Functions-Like-This/" class="">3.12. 如何写出这样的函数&#34;</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/3.-Functions/3.13.-Conclusion/" class="">3.13. 小结&#34;</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/3.-Functions/3.14.-SetupTeardownIncluder/" class="">3.14. 程序&#34;</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/3.-Functions/3.15.-Bibliography/" class="">3.15. 参考文献&#34;</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/10.-Classes/ch10/" class="">Ch10</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/11.-Systems/ch11/" class="">Ch11</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/12.-Emergence/ch12/" class="">Ch12</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/13.-Concurrency/ch13/" class="">Ch13</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/14.-Successive-Refinement/ch14/" class="">Ch14</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/15.-JUnit-Internals/ch15/" class="">Ch15</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/16.-Refactoring-SerialDate/ch16/" class="">Ch16</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/17.-Smells-and-Heuristics/ch17/" class="">Ch17</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/4.-Comments/ch4/" class="">Ch4</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/5.-Formatting/ch5/" class="">Ch5</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/6.-Objects-and-Data-Structures/ch6/" class="">Ch6</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/7.-Error-Handling/ch7/" class="">Ch7</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/8.-Boundaries/ch8/" class="">Ch8</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/9.-Unit-Tests/ch9/" class="">Ch9</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/Clean-Code/Appendix-A-Concurrency-II/apA/" class="">Ap A</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
    <a href="/docs/The-Go-Programming-Language/" class="collapsed ">Go语言圣经</a>
  

          
  
  
  

  

        </li>
      
    
  </ul>
  











  
<ul>
  
  <li>
    <a href="https://github.com/louyongjiu/gopl-zh-hugo" target="_blank" rel="noopener">
        Github
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>3.8. 分隔指令与询问&#34;</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#38-分隔指令与询问">3.8 分隔指令与询问</a></li>
      </ul>
    </li>
  </ul>
</nav>


  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h2 id="38-分隔指令与询问">
  3.8 分隔指令与询问
  <a class="anchor" href="#38-%e5%88%86%e9%9a%94%e6%8c%87%e4%bb%a4%e4%b8%8e%e8%af%a2%e9%97%ae">#</a>
</h2>
<p>Functions should either do something or answer something, but not both. Either your function should change the state of an object, or it should return some information about that object. Doing both often leads to confusion. Consider, for example, the following function:</p>
<blockquote>
<p>函数要么做什么事，要么回答什么事，但二者不可得兼。函数应该修改某对象的状态，或是返回该对象的有关信息。两样都干常会导致混乱。看看下面的例子：</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">set</span><span style="color:#f92672">(</span>String attribute<span style="color:#f92672">,</span> String value<span style="color:#f92672">);</span>
</code></pre></div><p>This function sets the value of a named attribute and returns true if it is successful and false if no such attribute exists. This leads to odd statements like this:</p>
<blockquote>
<p>该函数设置某个指定属性，如果成功就返回 true，如果不存在那个属性则返回 false。这样就导致了以下语句：</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>set<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;username&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;unclebob&#34;</span><span style="color:#f92672">))</span><span style="color:#960050;background-color:#1e0010">…</span>
</code></pre></div><p>Imagine this from the point of view of the reader. What does it mean? Is it asking whether the “username” attribute was previously set to “unclebob”? Or is it asking whether the “username” attribute was successfully set to “unclebob”? It’s hard to infer the meaning from the call because it’s not clear whether the word “set” is a verb or an adjective.</p>
<blockquote>
<p>从读者的角度考虑一下吧。这是什么意思呢？它是在问 username 属性值是否之前已设置为 unclebob 吗？或者它是在问 username 属性值是否成功设置为 unclebob 呢？从这行调用很难判断其含义，因为 set 是动词还是形容词并不清楚。</p>
</blockquote>
<p>The author intended set to be a verb, but in the context of the if statement it feels like an adjective. So the statement reads as “If the username attribute was previously set to unclebob” and not “set the username attribute to unclebob and if that worked then.…” We could try to resolve this by renaming the set function to setAndCheckIfExists, but that doesn’t much help the readability of the if statement. The real solution is to separate the command from the query so that the ambiguity cannot occur.</p>
<blockquote>
<p>作者本意，set 是个动词，但在 if 语句的上下文中，感觉它像是个形容词。该语句读起来像是说“如果 username 属性值之前已被设置为 uncleob”，而不是“设置 username 属性值为 unclebob，看看是否可行，然后……”。要解决这个问题，可以将 set 函数重命名为 setAndCheckIfExists，但这对提高 if 语句的可读性帮助不大。真正的解决方案是把指令与询问分隔开来，防止混淆的发生：</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>attributeExists<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;username&#34;</span><span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
    setAttribute<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;username&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;unclebob&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#960050;background-color:#1e0010">…</span>
<span style="color:#f92672">}</span>
</code></pre></div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">



  <div><a class="flex align-center" href="https://github.com/louyongjiu/gopl-zh-hugo/commit/898099ba91ff6f140943a2b4f4e73c671cddba9a" title='最后修改者 louyongjiu | 2020年9月1日' target="_blank" rel="noopener">
      <img src="/svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>2020年9月1日</span>
    </a>
  </div>



  <div>
    <a class="flex align-center" href="https://github.com/louyongjiu/gopl-zh-hugo/edit/master/content/docs/Clean%20Code/3.%20Functions/3.8.%20Command%20Query%20Separation.md" target="_blank" rel="noopener">
      <img src="/svg/edit.svg" class="book-icon" alt="Edit" />
      <span>编辑本页</span>
    </a>
  </div>

</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#38-分隔指令与询问">3.8 分隔指令与询问</a></li>
      </ul>
    </li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












